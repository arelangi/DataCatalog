<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Data Catalog Registration</title>
    <meta name="description" content="Register new data sets">
    <!-- Pico.css -->
    <link rel="stylesheet" href="https://unpkg.com/@picocss/pico@latest/css/pico.min.css">


    <!--Jquery -->
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"> </script>

    <!--Data tables-->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.11.4/css/jquery.dataTables.min.css">
    <script type="text/javascript" src="//cdn.datatables.net/1.11.4/js/jquery.dataTables.min.js"> </script>

    <script>
        var meta = 5;
        var counter = 1;
        $(document).ready(function () {

            var tbl = $('#quality_tbl').DataTable();
            $('#addRow').on('click',function(){
                tbl.row.add([
                '<select id="field_name" name="field_name_'+counter+'">{{range .payload.Fields}}<option value="{{ .Name }} "> {{ .Name }} </option>{{ end }}</select>',
                '<select id="rule_type" name="rule_type_'+counter+'" required><option value="Range">Range</option><option value="Valid Values">Valid Values</option></select>',
                '<input type="text" id="description" name="description_'+counter+'" placeholder="Rule Description" aria-label="Rule Description" required>',
                '<input type="text" id="values" name="values_'+counter+'"" placeholder="Comma separated values" aria-label="Comma separated values" required>'
                ]).draw(false);

                counter++;
            });




            $('#dataqualityrules-btn').on( 'click', function(event) {
                var  data = tbl.$('input, select').serialize();
                console.log(data);

                meta = data;
                /*
                $.ajax({
                    url: '/register/dataqualityrules',
                    dataType: 'json',
                    type: 'POST',
                    contentType: false,
                    data: new FormData(this),
                    processData: false,
                    success: function (data, textStatus, jQxhr) {
                    
                        for (var k in data){
                            $('#td_type_'+k).html('<p>'+data[k]+'</p>');
                        }

                        $('#dataqualityrules-btn').remove();
                        $('#navigation').html('<p><a href="/register/dataquality/{{ .payload.DatasetID }}">Setup DQ Checks</a></p>');
                        
                    },
                    error: function (jqXhr, textStatus, errorThrown) {
                        console.log(errorThrown);
                    }
                });
                */

                event.preventDefault();
            });

        });



    </script>
</head>

<body>

    <!-- Header -->
    <header class="container">
        <hgroup>
            <h1>Data Quality Rules</h1>
        </hgroup>
    </header><!-- ./ Header -->

    <!-- Main -->
    <main class="container">
        <div id="dataqualityrules_section">

        <br/>
        <div class="grid">
            <button id="addRow" style="width:15%" >Add new row</button>
        </div>
        <table id="quality_tbl" class="display" role="grid">
                <thead>
                    <tr>
                        
                        <th scope="col"> Field Name </th>
                        <th scope="col"> Rule Type </th>
                        <th scope="col"> Rule Description </th>
                        <th scope="col"> Values </th>
                    </tr>
                </thead>
                <tbody>
               
                

                </tbody>
                </table>
                <input type="hidden" name="datasetid" value="{{ .payload.DatasetID }}">
                <button type="submit" id="dataqualityrules-btn">Submit</button>
            
        </div>
        <br/><br/>
        <br/><br/>
        <div class="grid" id="navigation">
        </div>
            

            

        

    </main><!-- ./ Main -->

    <!-- Footer -->
    <footer class="container">
        <small></small><a href="#">Data Catalog</a> â€¢ <a href="#">Zendesk</a></small>
    </footer><!-- ./ Footer -->


</body>

</html>